import{r as l,q as E,j as r,B as C,L as G,T as i,n as J}from"./index-DxToOhWZ.js";import{U as O}from"./select-D_5_mR4D.js";import{U as n}from"./input-C_9GwNBk.js";import{U as v,g as L}from"./getImage-BTCROlbj.js";import{u as P,c as R}from"./apiUpdateCalls-c3S0mrRd.js";import{u as z}from"./useFetchGetAllDatas-BJ7_Q8Ee.js";import{g as H}from"./getFilteredList-DRM4hQLM.js";import"./settings-DvgpDYXI.js";import"./index-Cgmb0aMc.js";import"./IconButton-CfbDMdYV.js";import"./apiGetCalls-3rolZ__Z.js";const ie=({isEdit:h,data:e})=>{const[t,F]=l.useState({id:e==null?void 0:e.category,value:e==null?void 0:e.cat_library}),[c,I]=l.useState((e==null?void 0:e.title)||""),[p,T]=l.useState((e==null?void 0:e.author)||""),[x,U]=l.useState((e==null?void 0:e.type)||""),[g,A]=l.useState(e==null?void 0:e.year),[m,D]=l.useState((e==null?void 0:e.country)||""),[a,k]=l.useState((e==null?void 0:e.language)||""),[j,w]=l.useState((e==null?void 0:e.image)||null),[S,B]=l.useState((e==null?void 0:e.file)||null),[N,f]=l.useState(!1),b=E(),{data:d,loading:V}=z("library_category"),Y=H({data:d}),_=async()=>{if(!t||!c||!p||!x||!g||!m||!a)return;f(!0);const s=new FormData;if(s.append("title",c),s.append("category",t==null?void 0:t.id),s.append("author",p),s.append("type",x),s.append("year",g+""),s.append("country",m),s.append("language",a),s.append("author",p),h){const o=await L(e==null?void 0:e.image,"image");s.append("image",o);const q=await L(e==null?void 0:e.file,"file");s.append("file",q);for(var u of s.entries())console.log(u[0]+", "+JSON.stringify(u[1]));P("library",e==null?void 0:e.id,s,!0).then(y=>(b("/libraries",{replace:!0}),y)).catch(y=>console.log(y)).finally(()=>f(!1))}else j&&s.append("image",j[0]),S&&s.append("file",S[0]),R("library",s,!0).then(o=>(b("/libraries",{replace:!0}),o)).catch(o=>o).finally(()=>f(!1))};return r.jsxs(C,{children:[V&&r.jsx(G,{}),!V&&r.jsxs(C,{children:[r.jsxs(i,{sx:{margin:"5px 0"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Select Library Category"]}),r.jsx(O,{options:Y,placeholder:"",defaultValue:t||{id:"",value:""},updateValue:s=>{const u={id:s.id,value:s.value};F(u)}}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Title"]}),r.jsx(n,{updateValue:s=>I(s),defaultValue:c}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Author"]}),r.jsx(n,{updateValue:s=>T(s),defaultValue:p}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Type"]}),r.jsx(n,{updateValue:s=>U(s),defaultValue:x}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Year"]}),r.jsx(n,{updateValue:s=>A(Number(s)),type:"number",defaultValue:g}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Country"]}),r.jsx(n,{updateValue:s=>D(s),defaultValue:m}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Language"]}),r.jsx(n,{updateValue:s=>k(s),defaultValue:a}),r.jsx(i,{sx:{margin:"15px 0 5px"},children:"Click to upload an image"}),r.jsx(v,{fileChange:s=>w(s),id:"1",defaultFile:e==null?void 0:e.file}),r.jsx(i,{sx:{margin:"15px 0 5px"},children:"Click to upload an file"}),r.jsx(v,{fileChange:s=>B(s),id:"2",defaultFile:e==null?void 0:e.file}),r.jsx(J,{onClick:_,disabled:N,variant:"contained",sx:{marginTop:"20px"},children:h?"Update":"Create"})]})]})};export{ie as default};
