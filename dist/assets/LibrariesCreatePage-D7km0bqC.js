import{r as l,q,j as r,B as C,L as G,T as i,n as J}from"./index-D364flWg.js";import{U as O}from"./select-DdrCvlZP.js";import{U as n}from"./input-Bs0gHKzX.js";import{U as v,g as L}from"./getImage-DF1OkTmh.js";import{u as P,c as R}from"./apiUpdateCalls-pqf5ORJ6.js";import{u as z}from"./useFetchGetAllDatas-BGDv6uuA.js";import{g as H}from"./getFilteredList-BZJKHfen.js";import"./settings-CG1kX9pl.js";import"./index-1yGl0EKQ.js";import"./IconButton-C6Hk6J1h.js";import"./apiGetCalls-EJUCRfKo.js";const ie=({isEdit:h,data:e})=>{const[t,F]=l.useState({id:e==null?void 0:e.category,value:e==null?void 0:e.cat_library}),[c,I]=l.useState((e==null?void 0:e.title)||""),[u,T]=l.useState((e==null?void 0:e.author)||""),[x,A]=l.useState((e==null?void 0:e.type)||""),[g,U]=l.useState(e==null?void 0:e.year),[m,D]=l.useState((e==null?void 0:e.country)||""),[a,k]=l.useState((e==null?void 0:e.language)||""),[j,w]=l.useState((e==null?void 0:e.image)||null),[S,B]=l.useState((e==null?void 0:e.file)||null),[N,f]=l.useState(!1),b=q(),{data:d,loading:V}=z("library_category"),E=H({data:d}),Y=async()=>{if(!t||!c||!u||!x||!g||!m||!a)return;f(!0);const s=new FormData;if(s.append("title",c),s.append("category",t==null?void 0:t.id),s.append("author",u),s.append("type",x),s.append("year",g+""),s.append("country",m),s.append("language",a),s.append("author",u),h){const o=await L(e==null?void 0:e.image,"image");s.append("image",o);const _=await L(e==null?void 0:e.file,"file");s.append("file",_);for(var p of s.entries())console.log(p[0]+", "+JSON.stringify(p[1]));P("library",e==null?void 0:e.id,s,!0).then(y=>(b("/libraries",{replace:!0}),y)).catch(y=>console.log(y)).finally(()=>f(!1))}else j&&s.append("image",j[0]),S&&s.append("file",S[0]),R("library",s,!0).then(o=>(b("/libraries",{replace:!0}),o)).catch(o=>o).finally(()=>f(!1))};return r.jsxs(C,{children:[V&&r.jsx(G,{}),!V&&r.jsxs(C,{children:[r.jsxs(i,{sx:{margin:"5px 0"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Select Library Category"]}),r.jsx(O,{options:E,placeholder:"",defaultValue:t||{id:"",value:""},updateValue:s=>{const p={id:s.id,value:s.value};F(p)}}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Title"]}),r.jsx(n,{updateValue:s=>I(s),defaultValue:c}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Author"]}),r.jsx(n,{updateValue:s=>T(s),defaultValue:u}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Type"]}),r.jsx(n,{updateValue:s=>A(s),defaultValue:x}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Year"]}),r.jsx(n,{updateValue:s=>U(Number(s)),type:"number",defaultValue:g}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Country"]}),r.jsx(n,{updateValue:s=>D(s),defaultValue:m}),r.jsxs(i,{sx:{margin:"15px 0 5px"},children:[r.jsx("span",{style:{color:"red"},children:"*"})," Language"]}),r.jsx(n,{updateValue:s=>k(s),defaultValue:a}),r.jsx(i,{sx:{margin:"15px 0 5px"},children:"Click to upload an image"}),r.jsx(v,{fileChange:s=>w(s),id:"1",defaultFile:e==null?void 0:e.file}),r.jsx(i,{sx:{margin:"15px 0 5px"},children:"Click to upload an file"}),r.jsx(v,{fileChange:s=>B(s),id:"2",defaultFile:e==null?void 0:e.file}),r.jsx(J,{onClick:Y,disabled:N,variant:"contained",sx:{marginTop:"20px"},children:h?"Edit":"Create"})]})]})};export{ie as default};
